# name: Deploy ShikshaConnect to AWS

# on:
#   push:
#     branches:
#       - main

# jobs:
#   build-and-deploy:
#     runs-on: ubuntu-latest

#     steps:
#       - name: Checkout repository
#         uses: actions/checkout@v4

#       - name: Set up Node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: 18

#       - name: Install dependencies
#         run: npm ci

#       - name: Build Next.js app
#         run: npm run build

#       - name: Build Docker image
#         run: docker build -t shikshaconnect .

#       - name: Log in to Docker Hub
#         run: echo "${{ secrets.DOCKER_PASSWORD }}" | docker login -u ${{ secrets.DOCKER_USERNAME }} --password-stdin

#       - name: Push Docker image
#         run: docker tag shikshaconnect ${{ secrets.DOCKER_USERNAME }}/shikshaconnect:latest && docker push ${{ secrets.DOCKER_USERNAME }}/shikshaconnect:latest

#       - name: Deploy to AWS EC2
#         uses: appleboy/ssh-action@v0.1.10
#         with:
#           host: ${{ secrets.EC2_HOST }}
#           username: ubuntu
#           key: ${{ secrets.EC2_SSH_KEY }}
#           script: |
#             docker pull ${{ secrets.DOCKER_USERNAME }}/shikshaconnect:latest
#             docker stop shikshaconnect || true
#             docker rm shikshaconnect || true
#             docker run -d -p 80:3000 --name shikshaconnect ${{ secrets.DOCKER_USERNAME }}/shikshaconnect:latest